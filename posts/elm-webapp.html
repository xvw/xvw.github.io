<!DOCTYPE html>
<html>
    <head>
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-108165898-1"></script>
	<script>
	 window.dataLayer = window.dataLayer || [];
	 function gtag(){dataLayer.push(arguments);}
	 gtag('js', new Date());

	 gtag('config', 'UA-108165898-1');
	</script>

        <meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
	<link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700,700i|Playfair+Display:400,700,900|Fira+Mono" rel="stylesheet">
        <link rel="stylesheet" href="../css/default.css" />
        <title>xvw - Une application web moderne en Elm</title>
    </head>

    <body>
	<main class="article">
    <a href="../index.html">Revenir à l'accueil</a>
    <h1 class="main-title">Une application web moderne en Elm</h1>
    <div class="date">Publié le 25 du 10 2017</div>
    <blockquote>
<p>Depuis 2003, comme nous l’indique <a href="https://openclassrooms.com/courses/le-javascript-moderne">cet article, </a>le JavaScript est utilisé comme une <strong>bytecode</strong>, beaucoup de compilateurs/transpilateurs ciblent le JavaScript pour permettre à des développeurs d’écrire des applications web clientes dans leur langage favoris.</p>
<p>Les applications devenant de plus en plus complexes, principalement grâce à l’évolution des navigateurs web (qui est en un effet de bord à l’amélioration de notre matériel), beaucoup de développeurs ont fait le choix d’utiliser des <strong>langages statiquement typés</strong> pour faciliter le développement. On peut citer, entre autres, <a href="https://www.typescriptlang.org/">TypeScript</a>, <a href="http://www.purescript.org/">Purescript</a>, <a href="https://reasonml.github.io/">ReasonML/OCaml</a> (avec <a href="https://bucklescript.github.io/bucklescript/Manual.html">BuckleScript</a> ou <a href="http://ocsigen.org/js_of_ocaml/">Js_of_ocaml</a>) et <a href="http://elm-lang.org/">Elm</a>. Tous ces outils proposant chacun des avantages (et aussi des inconvénients).</p>
<p>Au contraire de beaucoup d’autres technologies, Elm embarque une architecture qui fait office de <strong>framework</strong> pour construire des applications web. Même si dans un premier temps, chaque exercice proposé par le site est très clair, lorsque l’on doit écrire une application “riche” qui propose plusieurs formes d’interactivité, il faut parfois ruser, et remettre en question des pratiques que l’on estimait bonne.</p>
<p>Dans cet article, je vous propose d’utiliser <strong>Elm</strong> et <strong>Elixir+Phoenix</strong> (même si nous nous intéresserons peu à la partie Elixir) pour construire une application web moderne !</p>
</blockquote>
<p>Elm est un langage qui s’inscrit dans la famille des langages <strong>ML</strong>, et sa syntaxe s’inspire fortement de <a href="https://haskell.org">Haskell</a>. On écrit une application “entière” en Elm et ensuite, elle est <strong>transpilée</strong> en JavaScript. En plus d’offrir une syntaxe confortable (et oui, inspirée de Haskell), Elm offre un système de types puissant et expressif, qui évite au maxium les erreurs à <strong>Runtime</strong>. De plus, le compilateur de Elm est très bavard et éloquent sur les manières de résoudre une erreur à la compilation.</p>
<p>En plus d’être un très beau langage (argument subjectif, je l’accorde), Elm impose une manière de structurer son application web que l’on appelle la <a href="https://guide.elm-lang.org/architecture/">Elm-architecture</a>. Cette architecture permet <a href="http://elm-lang.org/blog/farewell-to-frp">d’abstraire</a> les concepts complexes qui sont liés, entre autre, à la <strong>programmation fonctionnelle réactive</strong> (comme, par exemple, les <a href="http://haskell.cs.yale.edu/wp-content/uploads/2011/02/oxford02.pdf">flèches</a> ou les <a href="https://en.wikipedia.org/wiki/Functional_reactive_programming#Formulations_of_FRP">signaux</a>). De ce fait, Elm est un langage facile à appréhender, ce qui explique sans doute son succès grandissant dans le monde des applications <em>front-end</em>. De ce fait, l’auteur lui même dit que Elm n’est pas un langage fonctionnel reactif, cependant, il tient beaucoup des promesses liés à cette famille de langage.</p>
<h1 id="utilisation-de-la-elm-architecture">Utilisation de la Elm-architecture</h1>
<p>La Elm-architecture repose sur quelques pilliers :</p>
<ol>
<li>On représente les données via un type <code class="elm rundoc-block" rundoc-language="elm">Model</code> ;</li>
<li>la représentation de la page est une fonction qui prend en paramètre un <code class="elm rundoc-block" rundoc-language="elm">Model</code> ;</li>
<li>dans la fonction de vue, on peut envoyer des messages (de type <code class="elm rundoc-block" rundoc-language="elm">Message</code>) à une fonction de rafraîchissement ;</li>
<li>la fonction de rafraîchissement prend en argument un <code class="elm rundoc-block" rundoc-language="elm">Message</code> et un <code class="elm rundoc-block" rundoc-language="elm">Model</code> et renvoie une nouvelle version du <code class="elm rundoc-block" rundoc-language="elm">Model</code> ;</li>
<li>une application Elm est appelée un <strong>programme</strong> et initialize le modèle et définit la fonction de vue et celle de rafraîchissement.</li>
</ol>
<p>Dans ce premier exemple, nous allons simplement créer deux boutons et un texte qui affichera une valeur entière. Quand on appuyera sur le premier bouton, on incrémentera la valeur du texte, quand on appuyera sur le second, on décrémentera la valeur du texte.</p>
<p>(Vous pouvez retrouver une version exécutable de ce code <a href="http://elm-lang.org/examples/buttons">ici</a>.)</p>
<p>Dans cet exemple, notre modèle sera un nombre entier, celui qui sera affiché dans notre espace de texte. Et nous aurons deux messages possibles :</p>
<ol>
<li>un message pour incrémenter le modèle ;</li>
<li>un message pour décrémenter le modèle.</li>
</ol>
<p>Comme notre modèle est assez simple, la fonction de rafraîchissement est assez facile à implémenter.</p>
<pre class="elm"><code>type Msg 
 = Increment 
 | Decrement

update msg model =
  case msg of
    Increment -&gt;
      model + 1

    Decrement -&gt;
      model - 1
</code></pre>
<p>Rien de très complexe, on se sert <strong>d’unions discriminées</strong> pour définir les différents messages recevables (parce que c’est commun) et la fonction de rafraîchissement se contente, en cas de réception du message <code class="elm rundoc-block" rundoc-language="elm">Increment</code>, on renvoie le modèle auquel on ajoute <code class="elm rundoc-block" rundoc-language="elm">1</code>, en cas de réception du message <code class="elm rundoc-block" rundoc-language="elm">Decrement</code>, on renvoie le modèle auquel on retire <code class="elm rundoc-block" rundoc-language="elm">1</code>.</p>
<p>Maintenant que nous avons notre logique de traitement des messages, nous pouvons implémenter notre vue. En Elm, le HTML s’écrit au moyen de <strong>fonctions</strong> :</p>
<pre class="elm"><code>view model =
  div []
    [ button [ onClick Decrement ] [ text &quot;-&quot; ]
    , div [] [ text (toString model) ]
    , button [ onClick Increment ] [ text &quot;+&quot; ]
    ]
</code></pre>
<p>L’attribut <code class="elm rundoc-block" rundoc-language="elm">onClick</code>, qui est aussi une fonction, <strong>enverra</strong> un message à la fonction de rafraîchissement. Maintenant, il ne reste plus qu’a créer notre fonction <code class="elm rundoc-block" rundoc-language="elm">main</code> qui instanciera un <strong>programme</strong> :</p>
<pre class="elm"><code>main =
  beginnerProgram { 
    model = 0
  , view = view
  , update = update 
  }
</code></pre>
<p>Et voila, je vous invite à <a href="http://elm-lang.org/examples/buttons">tester le code en ligne</a>, au delà de quelques importations complémentaires, il n y a rien de plus que ce que j’ai montré.</p>
<p>La génération de la vue est largement optimisée grâce à l’utilisation d’un <a href="https://www.reddit.com/r/javascript/comments/2jav2q/is_there_any_good_standalone_implementation_of/cl9zrz1/?utm_content=permalink&amp;utm_medium=front&amp;utm_source=reddit&amp;utm_name=javascript">DOM virtuel</a>, qui va minimiser les transformations nécéssaire pour rendre la vue.</p>
    <div class="article-footer">
	Cet article est terminé ! <br /> Si jamais vous avez des
	remarques, n'hésitez pas à écrire un <strong>commentaire</strong>
	ou à <a href="https://github.com/xvw/blog">contribuer</a>

	<div id="disqus_thread"></div>
	<script>
	 
	 var disqus_config = function () {
	     this.page.url = "https://xvw.github.io/";  // Replace PAGE_URL with your page's canonical URL variable
	     this.page.identifier = "posts/elm-webapp.org"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
	 };
	 
	 (function() { // DON'T EDIT BELOW THIS LINE
	     var d = document, s = d.createElement('script');
	     s.src = 'https://xvw-blog.disqus.com/embed.js';
	     s.setAttribute('data-timestamp', +new Date());
	     (d.head || d.body).appendChild(s);
	 })();
	</script>
	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
</main>

	<footer>
	    Merci 
	    <a href="https://jaspervdj.be/hakyll/">Hakyll</a>, 
	    tu es un superbe générateur ❤ 
	</footer>
    </body>
    <script src="../js/hl.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</html>
