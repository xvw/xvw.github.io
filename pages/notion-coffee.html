<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>xvw - Indexation de café avec Notion</title>
    <meta name="description" content="Exemple d&apos;utilisation de Notion pour l&apos;indexation de café" />
    <meta name="keywords" content="capsule, lowcode, nocode, notion, café, base de données" />
    <meta name="author" content="Xavier Van de Woestyne" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="og:title" content="Indexation de café avec Notion" />
    <meta name="og:description" content="Exemple d&apos;utilisation de Notion pour l&apos;indexation de café" />
    <meta name="twitter:title" content="Indexation de café avec Notion" />
    <meta name="twitter:description" content="Exemple d&apos;utilisation de Notion pour l&apos;indexation de café" />
    <meta name="twitter:creator" content="@vdwxv" /><link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="/css/hl.css" />
    <link rel="stylesheet" href="/css/default.css" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="alternate" type="application/atom+xml" href="/atom.xml" />
    <link rel="alternate" type="application/atom+xml" href="/journal.xml" />
    <link rel="alternate" type="application/atom+xml" href="/pages.xml" />
    <link rel="alternate" type="application/atom+xml" href="/addresses.xml" />
    <script src="/js/hell.js"></script>
    <script src="/js/capsule_client.bc.js"></script>
  </head>
  <body>
    <main class="container"><section class="header">
  <nav class="breadcrumb">
    <ol>
      <li>
        <a href="/">Accueil</a>
      </li><li>
        <a href="/coffee.html">Sur le café</a>
      </li><li>
        <a href="/coffee.html#index-technologies">Technologies</a>
      </li></ol>
  </nav>

  <h1>Indexation de café avec Notion</h1><time class="published-at" datetime="2024-01-23">
    2024-01-23
  </time><time class="updated-at" datetime="2024-03-12">
      2024-03-12
  </time></section><section class="synopsis"><p>Cet article est une réinterprétation d'un <a href="https://github.com/xvw/planet/blob/master/content/posts/notion-cafe.org">article</a> que j'avais rédigé en 2021, sur mon <a href="https://github.com/xvw/planet">ancien site</a>. J'ai essayé d'aller à l'essentiel et il présente, dans les grandes lignes, l'ensemble des pages <a href="https://www.notion.so/about">Notion</a> mises en place pour me permettre d'indexer ma consommation de café et tenter de construire une intuition sur la compréhension des mes goûts. De manière générale, je pense que se construire une <em>base de connaissances</em> est une bonne pratique quand on tente de découvrir une discipline. Étant loin d'être un expert en café et avec Notion, il est probable qu'une grande partie de ce que je décris dans cet article semble naïf ! Pour résumer, cet article présentera la manière dont j'ai mis en place une infrastructure pour indexer les cafés que je goûte, en vue de me fournir des métriques précises m'aidant à caractériser mes préférences, au moyen de l'outil Notion, tout en présentant quelques techniques et ruses apprises lors de la mise en place de ce système.</p>
</section><section class="table-of-contents"><ul>
<li><ul>
<li><a href="#-propos-de-notion">À propos de Notion</a>
<ul>
<li><a href="#sur-le-nocodelowcode">Sur le NoCode/LowCode</a>
</li>
<li><a href="#organisation-de-lespace-de-travail">Organisation de l'espace de travail</a>
<ul>
<li><a href="#sur-les-bases-de-donnes">Sur les bases de données</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#premires-caractristiques">Premières caractéristiques</a>
<ul>
<li><a href="#de-larbre--la-tasse">De l'arbre à la tasse</a>
</li>
<li><a href="#note-sur-la-rplicabilit">Note sur la réplicabilité</a>
</li>
</ul>
</li>
<li><a href="#modlisation-des-tables">Modélisation des tables</a>
<ul>
<li><a href="#dcrire-les-fermesproducteurs-et-les-torrfacteurs">Décrire les fermes/producteurs et les torréfacteurs</a>
<ul>
<li><a href="#un-premier-ensemble-de-tables-les-zones-gographiques">Un premier ensemble de tables: les zones géographiques</a>
<ul>
<li><a href="#la-technique-des-champs-miroirs">La technique des champs miroirs</a>
</li>
</ul>
</li>
<li><a href="#dcrire-une-ferme">Décrire une ferme</a>
</li>
<li><a href="#dcrire-les-torrfacteurs">Décrire les torréfacteurs</a>
<ul>
<li><a href="#un-premier-outil--torrfacteurs--essayer">Un premier outil : torréfacteurs à essayer</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#modlisation-du-caf-des-varits-et-des-grains">Modèlisation du café, des variétés et des grains</a>
<ul>
<li><a href="#dcrire-les-varits-de-caf">Décrire les variétés de café</a>
</li>
<li><a href="#dcrire-les-grains-torrfis">Décrire les grains torréfiés</a>
<ul>
<li><a href="#amlioration-triviale">Amélioration triviale</a>
</li>
<li><a href="#un-second-outil-diversifier-les-expriences">Un second outil: diversifier les expériences</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#modlisation-des-recettes-et-expriences">Modèlisation des recettes et expériences</a>
<ul>
<li><a href="#dcrire-les-machines--caf">Décrire les machines à café</a>
</li>
<li><a href="#dcrire-une-recette">Décrire une recette</a>
<ul>
<li><a href="#explication-du-ratio">Explication du ratio</a>
</li>
<li><a href="#un-troisime-outil--un-assistant-de-calcul">Un troisième outil : un assistant de calcul</a>
</li>
</ul>
</li>
<li><a href="#dcrire-une-exprimentation">Décrire une expérimentation</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#plus-de-tableaux-de-bords">Plus de tableaux de bords</a>
<ul>
<li><a href="#relations-bi-directionnelles">Relations bi-directionnelles</a>
<ul>
<li><a href="#relations-bi-directionnelles-et-rollups--score-moyen">Relations bi-directionnelles et Rollups : score moyen</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#en-conclusion">En conclusion</a>
<ul>
<li><a href="#aprs-2-ans-dutilisation">Après ~2 ans d'utilisation</a>
</li>
<li><a href="#sur-notion-et-le-lowcode">Sur Notion et le LowCode</a>
</li>
<li><a href="#la-suite">La suite</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</section><article><p>Alors que généralement, tant que l'on est pas <em>tombé</em> dans le monde très rigolo
du <strong>café de spécialité</strong>, on se contente d'accepter une tasse, sans se
soucier <em>réellement</em> des caractéristiques de ce que l'on boira. Pourtant, il
existe <strong>beaucoup</strong> de critères qui influeront sur la tasse : la provenance des
grains, la variété du café, sa méthode de sechage, le profil de torréfaction, la
méthode d'extraction et bien d'autres. Un peu à la manière du vin, <em>comprendre
ce que l'on goûte</em> est primordial pour appréhender le café de spécialité et pour
développer l'intérêt que l'on porte au produit, comprendre comment choisir son
café et comment le préparer correctement — en réduisant, potentiellement, le
nombre d'étapes nécéssaires pour approcher, en fonction de ces caractéristiques,
la tasse idéale.</p>
<p>Dans cet article, je vais présenter <strong>mon utilisation de Notion</strong> pour la
construction d'un suivi de mes préparations (une base de données), me permettant
de <em>comprendre ma manière d'apprécier le café</em> et d'être capable de définir, en
fonction des méthodes d'extractions, une recette adaptée pour tenter d'extraire
des tasses correspondant à <em>mes préférences</em> et, potentiellement, de m'adapter
aux attentes de mes invités !</p>
<p>Par contre, cet article n'est ni un guide d'utilisation de Notion
<em>génériquement</em>, ni une introduction au café de spécialité, c'est un compte
rendu de modélisation sur la manière dont j'ai décidé d'organiser mon indexation
de café pour collecter des métriques sur mes préférences.</p>
<h2 id="-propos-de-notion">À propos de Notion</h2>
<p>Il est très difficile de résumer Notion autrement qu'en utilisant le néologisme
<a href="https://fr.wikipedia.org/wiki/Id%C3%A9ateur_(informatique)"><em>idéateur</em></a>. En
général, quand j'essaie de le décrire à mon entourage, je le présente comme un
outil de prise de notes, <em>boosté aux stéroïdes</em>, permettant de manipuler, entre
autres, des <em>spreadsheets</em> comme valeurs de première ordre. Depuis plusieurs
années, ce genre d'outils de prises de notes évolués est devenu très populaire
et leur versatilité les fait s'inscrire dans une mouvance que l'on appelle
<a href="https://fr.wikipedia.org/wiki/D%C3%A9veloppement_No_code"><em>NoCode/LowCode</em></a>. On
en trouve beaucoup et, à ma connaissance, les plus populaires (spécifiquement en
extension d'outils de prise de notes) sont <a href="https://obsidian.md/">Obsidian</a>,
<a href="https://anytype.io/">AnyType</a>, <a href="https://evernote.com/fr-fr">Evernote</a> et
Notion. Je n'ai pas d'opinions très arrêtées sur quel outil privilégier — même
si, pour des raisons idéologiques, je devrais passer un peu plus de temps à
jouer avec AnyType, qui a le très bon goût d'être <strong>libre</strong> et <em>local-first</em>. De
plus, une grande partie de ce que je vais présenter dans cet article pourrait
parfaitement fonctionner avec un logiciel <em>plus spécifique</em>, comme
<a href="https://www.airtable.com/">Airtable</a> par exemple ou encore avec une base de
données relationnelle classique, mais quand j'ai commencé à indexer ma
consommation de café, je voulais un outil générique pour assurer
<strong>l'intégralité</strong> de ma prise de notes numériques.</p>
<p>En complément, à l'époque où j'ai rédigé la première version de cet article,
<a href="https://www.shubham-sharma.fr/">Shubham Sharma</a> parlait beaucoup de Notion sur
sa <a href="https://www.youtube.com/channel/UCLKx4-_XO5sR0AO0j8ye7zQ">chaine Youtube</a> et
il proposait une <a href="https://www.notionfacile.fr/">Formation gratuite</a> pour prendre
l'outil en main ! De plus, à cette époque, je travaillais chez <a href="https://memo.bank/">Memo
Bank</a> et, l'un de mes collègues, <a href="https://jonathanlefevre.com/">Jonathan
Lefèvre</a>, avait, lui aussi, beaucoup de retours
sur Notion et, à la relecture de la première version, m'avait fait l'honneur de
me dire (approximativement dans ces termes) :</p>
<blockquote>
<p>C'est toujours amusant et intéressant de voir un programmeur utiliser Notion,
et, toi aussi, tu as trouvé un usage bien particulier et un peu flippant pour
les non-initiés.</p>
</blockquote>
<p>En bref, je ne sais pas si Notion est l'outil le plus adapté, et je ne sais pas
si je m'en suis servi de manière pertinente (<em>n'ayant pas eu pour objectif
d'augmenter drastiquement ma productivité</em>) mais après 2 ans d'utilisations, je
suis assez satisfait de l'amélioration de la <strong>compréhension des mes goûts</strong> en
matière de café !</p>
<h3 id="sur-le-nocodelowcode">Sur le NoCode/LowCode</h3>
<p>J'adore réinventer la roue, il peut donc sembler étrange que je décide
d'utiliser un logiciel propriétaire alors que je pourrais simplement
<em>réimplémenter</em> toute une suite de logiciels dédiée au café ! D'autant plus que,
sur un espace de conversation partagé que je fréquentais beaucoup en 2020, le
<em>NoCode</em> (dont l'appellation <em>LowCode</em> était encore assez confidentielle) avait
très mauvaise réputation.</p>
<p>Pour être honnête, je suis très favorable au <em>NoCode/LowCode</em> dans le sens où
ils me permettent de me focaliser sur <strong>la problématique que je veux adresser</strong>
et même si je suis convaincu que pour utiliser <em>très efficacement</em> des outils de
ce genre, il vaut mieux être familier avec la programmation (qui requiert une
certaine forme de logique et des qualités de modèlisation), mon seul <em>réel</em>
reproche à cette collection d'outils porte sur leur nom. En effet, on programme
toujours et l'utilisation d'un outil <em>dit de &quot;NoCode</em>, ne dispense pas d'un
architecte capable de construire une solution pertinente.</p>
<p>De mon point de vue, utiliser des Notion's et consorts me permet d'avoir de la
génération de formulaires, <em>gratuitement</em>, et donc de pouvoir me focaliser sur
le <strong>traitement de la donnée</strong> plutôt que sur la saisie, ce qui, dans beaucoup
de cas, est un gain de temps monumental.</p>
<p>Par contre, comme évoqué précédemment, il est probable que 2024 soit l'année où
je me pencherai sérieusement sur <a href="https://anytype.io">AnyType</a> pour privilégier
un <strong>logiciel libre</strong> et <strong>_local-first</strong>, parce que le fait de ne pas devoir
écrire chaque ligne de code, caractère par caractère, me semble beaucoup moins
problématique, <em>idéologiquement parlant</em> que de devoir me reposer sur des
technologies propriétaires, pour lesquelles je n'ai pas de gouvernance de ma
propre données.</p>
<h3 id="organisation-de-lespace-de-travail">Organisation de l'espace de travail</h3>
<p>Notion permet de structurer des documents hiérarchisés — des documents peuvent
en contenir d'autres. Chacun de ces documents sont une collection de blocs dont
le comportement varie en fonction du besoin. On retrouve des blocs de titre, des
paragraphe, des images, mais ils peuvent aussi référencer d'autres documents,
des fragments de documents ou encore des <em>vues</em> paramétrées par des sources de
données. La versatilité des blocs permet d'organiser proprement son espace de
travail.</p>
<p>Comme un espace Notion ne sert pas qu'à un seul usage, j'ai organisé l'ensemble
de mes pages dédiées à l'indexation du café dans un document, appellé sobrement
<code>Coffee</code> (auquel j'ai ajouté l'<em>émoji</em> <code>:coffee:</code> parce que je suis moderne et
que j'utilise des <em>émojis</em>). Ce premier document fait office d'ombrelle, on peut
le voir comme un <em>espace nom</em> ou encore un <em>répertoire</em>. Dans ce même document,
j'ajoute un nouveau document <code>database</code> (associé à l'icone <code>:disquette</code>) dans
lequel je placerai toutes mes tables. Ensuite, je pourrai construire des vues
(qui consomment ces tables), elles aussi, dans le document <code>Coffee</code> pour
adresser des services spécifiques. Le fait de compartimenter <strong>la donnée brute</strong>
est probablement une coquetterie de développeur mais j'en suis satisfait.</p>
<h4 id="sur-les-bases-de-donnes">Sur les bases de données</h4>
<p>les <a href="https://www.notion.so/help/intro-to-databases">bases de données Notion</a>
sont probablement une des fonctionnalités les plus utiles (de mon point de vue).
Elles permettent de décire des tables, dans le sens qu'on leur donne dans le
monde des bases de données relationnelles avec la possibilité d'embarquer des
champs qui sont des formules dont la valeur est définie en dépendant d'autres
champs. C'est en partie pour ça que je considère que les bases de données Notion
sont à l'intersection entre une table et une feuille de calcul.</p>
<p>Comme il y a vraiment beaucoup de fonctionnalités attachées aux base de données,
je tâcherai d'expliquer, au fil de l'article, les différentes fonctions
utilisées (quand il y aura des ambiguïtés potentielles).</p>
<h2 id="premires-caractristiques">Premières caractéristiques</h2>
<p>Maintenant que nous avons <em>sommairement</em> survolé quelques caractéristiques liées
à Notion, nous pouvons nous intéresser au café, à <em>proprement parlé</em>. Notre
exercice sera d'essayer de comprendre le cycle de vie du café, <strong>de l'arbre à la
tasse</strong> pour extraire des éléments qui <strong>serviront à la modèlisation de notre
système</strong>. Au travers de cette modèlisation, on pourra décrire une collection de
tables qui serviront, ensuite, à décrire des vues pour répondre à des questions
factuelles. C'est, de mon point de vue, la partie la plus amusante et j'ai
l'intime conviction que, peu importe que l'on utilise du <em>NoCode/LowCode</em> ou que
l'on programme entièrement l'application <em>from-scratch</em>, la démarche est
identique (et fondamentale).</p>
<h3 id="de-larbre--la-tasse">De l'arbre à la tasse</h3>
<p>Pour dériver des modèles pertinents à notre indexation, il est important de
comprendre le cycle de vie du café. En effet, en observant les différentes
étapes par lesquelles on passe depuis l'arbre, jusqu'au café en grain qui
servira à une préparation, on peut isoler une collection de critères qui
influeront sur la <em>tasse</em>. N'étant pas (encore, je l'espère) un expert, il est
probable que ma compréhension du cycle est naïve et maladroite, je suis donc
ouvert à toute proposition d'amélioration !</p>
<p>Dans les grandes lignes, le commerce du café implique plusieurs parties :</p>
<ul>
<li>les producteurs, qui possèdent des fermes de caféiers et qui assurent le
séchage des grains ;
</li>
<li>les exportateurs, qui rappatrient les grains vers des torréfacteurs ;
</li>
<li>les torréfacteurs, qui torréfient les grains ;
</li>
<li>les commercants, qui fournissent les revendeurs et les <em>coffee-shops</em> ;
</li>
<li>les préparateurs (<em>baristas</em> ou <em>consommateur final</em>).
</li>
</ul>
<p>Il est évident que ces différentes parties ne forment pas toujours des groupes
absolument hétérogènes. Il est très courant qu'un torréfacteur soit aussi
commercant (voire <em>barista</em>). Mais cette <em>découpe</em> des différentes parties
impliquées nous permet de décrire un schéma sommaire du trajet du café, <em>depuis
l'arbre, jusqu'à la tasse</em> :</p>
<p><img src="/images/coffee-to-cup.svg" alt="" class="centered-fig" /></p>
<ol>
<li>
<p><strong>La récolte</strong> :<br />
Cette étape permet de mettre en lumière plusieurs critères. Premièrement, la
<strong>région géographique</strong> où le café à été récolté, et par extension, <strong>le
producteur</strong> (ou la ferme) et l'altitude du plan, le <strong>type d'arbre</strong>
(naïvement, <strong>Robusta</strong> contre <strong>Arabica</strong>, même si, généralement, dans le
café de spécialité, on ne trouve presque qu'exclusivement de l'arabica), la
<strong>variété du café</strong> et des informations relatives aux dates de récoltes.</p>
</li>
<li>
<p><strong>Le séchage</strong> :<br />
En tant que consommateur, on est habitué à me voir que du café en grain
(voire moulu), mais <strong>le grain de café est le coeur d'une cerise</strong>. Il existe
plusieurs techniques de séchages, <em>naturel</em>, <em>lavé</em> ou encore <em>honey</em> (qui
possède plusieurs variations spécifiques) qui <strong>influent énormement</strong> sur le
goût en tasse. Ce <strong>processus</strong> est une critère indispensable. J'ai
l'intention d'écrire un article entièrement dédié à l'explication des
différents processus de séchage.<br />
En complément du séchage, certains producteurs ajoutent une étape de
<strong>fermentation complémentaire</strong> (pouvant être, par exemple, <em>anaérobique</em> ou
encore <em>carbonique</em>) qui, elle aussi, influe grandement sur les arômes du
café. Au vue des conditions écologique, le café est devenu un produit de luxe dont
l'importation peut se révéler coûteuse ce qui amène certains producteurs à
expérimenter des techniques <strong>d'altérations aromatiques</strong> au moment de la
fermentation influant, elles aussi, grandement sur les arômes du café.</p>
</li>
<li>
<p><strong>La torréfaction</strong> :<br />
La torréfaction, grossièrement, la <em>cuisson</em> des grains verts, pour en
révéler les arômes, joue en rôle essentiel (logique) sur la tasse finale. En
France, c'est généralement le torréfacteur qui choisi les producteurs et les
fermes avec lesquels il veut travailler ce qui nous permet d'extraire de
nouveaux critères : le <strong>torréfacteur</strong>, le <strong>niveau de torréfaction</strong>, le
<strong>profil aromatique</strong> du café et la <strong>date de torréfaction</strong>.</p>
</li>
<li>
<p><strong>La préparation</strong> :<br />
La manière de préparer un café influe aussi très fort sur la tasse finale, et
est conditionné par plusieurs critères : la <strong>recette utilisée</strong>, la
<strong>quantité de café</strong>, la <strong>quantité d'eau</strong>, la <strong>taille de la mouture</strong>, la
<strong>température de l'eau</strong>, la <strong>fraicheur du café</strong>, le <strong>temps
d'extraction</strong>, en bref, toutes les variables de la recette. Ce qui nous
permet de spéculer sur le fait que l'appréciation générale d'un café se fait
<strong>par recette pour un <em>batch de torréfaction</em> précis</strong>.</p>
</li>
</ol>
<p>C'est une vision assez large (et pour le moment, floue) des différents critères
que l'on va utiliser pour décrire notre modélisation. Rassurez-vous, quand nous
construirons explicitement les tables et les vues, je tâcherai de revenir sur
les différents critères utilisés.</p>
<p>Les lecteurs plus attentifs remarqueront que je n'ai absolument pas parlé du
processus d'exportation. Pour être très honnête, je n'ai aucune idée de comment
ça se passe et je ne suis pas convaincu qu'il soit possible (de manière
consistante), d'être aux faits de critères liés à l'exportation, c'est pour
cette raison que je me permet discrètement de ne pas m'en soucier. En
complément, la <strong>fraicheur</strong> des grains utilisés lors d'une préparation influent
aussi sur la tasse, les conditions de stockages — type de récipient, exposition
à la lumière etc. — devraient être un critère d'indexation. Cependant, comme
j'utilise une méthode de conditionnement assez consistante (et que j'applique à
tout mes cafés), je n'ai pas trouvé qu'il était pertinent de la mettre en
lumière dans mon indexation !</p>
<h3 id="note-sur-la-rplicabilit">Note sur la réplicabilité</h3>
<p>Dans l'esquisse des critères que nous avons sélectionné, la recette joue un rôle
très important. Pour que l'indexation soit pertinente, il faut donc être capable
de reproduire précisement une recette et en collecter un maximum de métriques.
De plus, imaginez que vous soyez en train de savourer la plus délicieuse tasse
que vous ayez jamais produites, il serait terrible ne pas être capable de la
reproduire pour des raisons d'imprécisions de mesure ! Pour cela, j'utilise une
collection d'outils précis :</p>
<ul>
<li>
<p>un moulin à cliques, le <a href="https://www.comandantegrinder.com/">Commandante C40</a>.
Un moulin à clique permet de contrôler précisemment la <em>granulométrie</em> de la
mouture et le Commandante est un moulin très polyvalent dont les réglages au
cliques forment presque un <em>standard</em> de réglage. Le moulin est vraiment un
outil nécéssaire car le café perd une grande partie de ses arômes 15 minutes
après mouture ;</p>
</li>
<li>
<p>une balance, la <a href="https://brewista.co/products/smart-scale-2">Smart Scale 2 de
Brewista</a>, précise et doté d'un
chronomètre, que j'utilise pour peser les quantité de café et d'eau. (Ce qui
me permet d'éviter les mesures volumétriques, souvent assez peu précises et
peu réplicables) ;</p>
</li>
<li>
<p>une bouilloire avec une gestion de la température précises (me permettant de
changer degré par degré) et idéalement doté d'un col de cygne (pour le café
filtre), j'utilise la <a href="https://brewista.co/products/artisan-electric-gooseneck-kettle">Artisan Electric Gooseneck Kettle
</a>, elle aussi,
de chez <a href="https://brewista.co/">Brewista</a></p>
</li>
</ul>
<p>Le dernier point peut sembler anecdotique, mais dans une tasse de café, ce n'est
pas le café qui est le plus présent, mais <strong>l'eau</strong>. Ne disposant pas de
purificateur d'eau, j'ai opté pour une carafe <a href="https://www.brita.fr/">Brita</a>, me
permettant de diminuer au maximum le <a href="https://en.wikipedia.org/wiki/PH">Potentiel
Hydrogène</a> de mon eau. A tout cela s'ajoute
une collection de machines à café (un peu excessives) cependant, l'indexation
peut ne commencer qu'avec une seule machine ! Et maintenant que ces
clarifications sur la terminologies ont été évoquées, nous pouvons passer à la
modélisation concrète de notre système dans Notion.</p>
<h2 id="modlisation-des-tables">Modélisation des tables</h2>
<p>Même si, normalement, on commence pas construire des <em>user-stories</em> pour dériver
un modèle pertinent, comme un espace Notion est moins difficile à faire évoluer
qu'une base de données utilisée en production et que l'établissement un peu naïf
du cycle de vie du café nous donne des intuitions sur quels sont les variables
que l'on voudrait tracker, je me permet de construire des tables qui me
serviront à décrire la données que je voudrai exploiter dans des vues
spécifiques. Nous allons donc pouvoir remplir notre document <code>database</code> avec des
tables. L'ensemble de ces tables est organisée par thème, mais je pense que pour
les besoins de cet article, il n'est pas nécéssaire de documenter cette
organisation (qui est un peu à la préférence de chacun).</p>
<h3 id="dcrire-les-fermesproducteurs-et-les-torrfacteurs">Décrire les fermes/producteurs et les torréfacteurs</h3>
<p>Même si je me suis intéressé tardivement aux fermes et aux producteurs, j'ai, à
force de goûter de plus en plus de café, appris à <em>détecter</em> des fermes dont
j'apprécie toujours les récoltes (par exemple, l'extraordinaire <a href="https://www.panamavarietals.com/copy-of-cafe-gallardo">Finca
Hartmann</a>, de Panama).
Donc avant de décrire une ferme sommairement, il est important de pouvoir la
positionner géographiquement.</p>
<h4 id="un-premier-ensemble-de-tables-les-zones-gographiques">Un premier ensemble de tables: les zones géographiques</h4>
<p>Attaquons-nous à notre première modélisation, où nous seront confronté à la
construction de <strong>relation entre des tables</strong> ! Ma modèlisation est assez simple, je
distingue 4 tables : Le continent, le pays, la région et la ville. Ces 4 niveaux
me permettent d'avoir une granularité suffisamment fine (même si la terminologie
n'est pas uniforme pour tous les pays. Par exemple, au Panama, on parlera de
<a href="https://fr.wikipedia.org/wiki/Corregimiento"><em>corregimiento</em></a> plutôt que de
région).</p>
<p>Je n'ai pas besoin d'informations autres que le nom (qui fait office d'index) et
d'un treillis de relation suivant cet ordre : <code>cities -&gt; regions -&gt; countries -&gt; continents</code>. Voici une vue schématique du modèle des zones géographiques (que
j'ai placé dans un document nommé <code>Location</code>) :</p>
<p><img src="/images/coffee-geopoint.svg" alt="" class="centered-fig" /></p>
<p>Vous remarquerez que j'ai ajouté des relations <em>en pointillés</em> (avec le label
<code>rollup</code>). Dans Notion, on trouve deux formes de relations :</p>
<ul>
<li>les relations <em>standards</em> qui référencent directement une autre table ;
</li>
<li>les <em>rollups</em>, qui décrivent <strong>champ de relation</strong>. C'est très similaire des
<a href="https://en.wikipedia.org/wiki/Delegation_(object-oriented_programming)"><em>Delegates</em></a>
en programmation orientée objets. En d'autres termes, <strong>un Rollup est un champ
virtuel calculé depuis une relation</strong>.
</li>
</ul>
<p>Les <em>Rollups</em> permettent d'ajouter du contexte à ma table, et <strong>ne doivent pas
être remplis manuellement</strong>, en effet, dès que j'ai nommé, par exemple, une
région, et que je lui ai attribué un pays, le champ continents sera
automatiquement calculé. Il existe cependant une petite restrictions aux
<em>Rollups</em>, <strong>il est impossible de décrire un Rollup qui prend un autre Rollup
comme source</strong>. En effet, les Rollups prennent <strong>toujours</strong> des relations en
source. Dans le schéma de la modélisation, on peut voir que je recense, par
exemple, dans <code>cities</code>, le pays et le continent dans lequel il se trouve, or, si
l'on s'en tient à mon affirmation sur les Rollups de Rollups, ça devrait être
impossible. Il existe une astuce !</p>
<h5 id="la-technique-des-champs-miroirs">La technique des champs miroirs</h5>
<p>Dans notre exemple, on dispose des tables <code>continents</code>, <code>countries</code>, <code>regions</code>
et <code>cities</code>. Pour des raisons de lisibilité, je voudrais :</p>
<ul>
<li>les entrées de <code>countries</code> listent leur <code>continent</code> associé ;
</li>
<li>les entrées de <code>regions</code> listent leurs <code>country</code> et transitiviement leur
<code>continent</code> associés ;
</li>
<li>les entrées de <code>cities</code> listent leur <code>region</code>, transitivement leur <code>country</code>
et transitiviement leur <code>continent</code>.
</li>
</ul>
<p>Nous savons que :</p>
<ul>
<li>les <strong>relations</strong> permettent de référencer un directement une entrée ;
</li>
<li>les <strong>rollups</strong> permettent de cibler un champ d'une référence
(transitivement).
</li>
</ul>
<p>Comme un <strong>Rollup</strong> utilise toujours une relation comme source, il n'est pas
possible, dans le cas de <code>cities</code> de remonter le continent — c'est d'ailleurs la
seule table pour laquelle le problème se pose car <code>country</code> ne peut n'utiliser
qu'une seule relation pour exprimer son continent, <code>region</code> utilise une relation
pour exprimer son <code>country</code> et un Rollup pour faire remonter le continent et
dans le cas de <code>cities</code>, une relation exprimera la <code>region</code>, un Rollup remontera
le <code>country</code>, mais on ne pourra pas faire remonter le continent.</p>
<p>Pour permettre à <code>cities</code> d'accéder au continent de <code>regions</code>, il suffit
d'utiliser un <strong>champ miroir</strong>, que j'ai appelé <code>_mirror_continent</code> qui sera une
formule et qui sera égal à <code>prop(&quot;Continent&quot;)</code>. Ça a pour effet de créer un
second champ qui est strictement équivalent au champ <code>Continent</code>, sauf que ce
champ n'est pas le résultat d'un Rollup (et ce, même si c'est le cas de la
propriété <code>Continent</code>). Il devient donc possible de référencer ce champs depuis
<code>cities</code> en créant un autre Rollup pointant la région et en référençant notre
nouveau champ <code>_mirror_continent</code> qui lui, n'est pas le résultat du calcul d'un
Rollup, et rendre explicite le continent dont fait partie une ville.</p>
<p>Pour les férus de <strong>l'encapsulation</strong>, Notion permet facilement de cacher des
champs de la vue générale, permettant de garder notre vue de <code>regions</code> facile à
lire. Dans la suite de l'article, je ne distinguerai pas spécialement
l'utilisation d'un champ miroir ou d'un Rollup, le premier n'étant qu'un détail
technique nécéssaire pour combler une limite inhérente au Rollups.</p>
<h4 id="dcrire-une-ferme">Décrire une ferme</h4>
<p>Maintenant que nous pouvons <em>localiser</em> une ferme, nous pouvons les décrire.
L'exercice n'est pas très compliqué. En effet, je me contente de recenser les
champs me permettant de construire un <em>annuaire</em> de fermes :</p>
<p><img src="/images/coffee-farm.svg" alt="" class="centered-fig" /></p>
<p>J'ai besoin d'un <strong>nom</strong> et d'un <strong>site</strong> (ou d'une page sociale) et de
référencer la <strong>ville</strong> dans laquelle se trouve la ferme. Et de manière générale,
je trouve ça intéressant d'avoir une rapidement accès au pays, d'où la présence
d'un Rollup (qui nécéssite d'ajouter un <strong>champ miroir</strong> sur <code>country</code> dans
<code>cities</code>). Maintenant, nous pouvons décrire les torréfacteurs.</p>
<h4 id="dcrire-les-torrfacteurs">Décrire les torréfacteurs</h4>
<p>La description des torréfacteurs n'est pas foncièrement différentes de celle des
fermes. On y retrouvera des champs en communs — <strong>Nom</strong>, <strong>Ville</strong>, un Rollup
depuis la ville vers le <strong>Pays</strong> et une <strong>Url</strong>. J'ai ajouté une adresse précise
(essentiellement pour référencer une <em>rue</em>), car il est plus courant que je
veuille me rendre dans la boutique d'un torréfacteur plutôt que dans la ferme du
producteur et deux champs booléens pour exprimer <strong>si j'ai déjà testé de leur
café</strong> et si le <strong>torréfacteur est encore actif</strong>.</p>
<p><img src="/images/coffee-roaster.svg" alt="" class="centered-fig" /></p>
<p>Le fait de conserver les torréfacteurs inactifs me permet d'avoir une indexation
cohérente. Le fait d'avoir un marqueur décrivant si un café dans du torréfacteur
à déjà été goûté/testé permet de créer un premier outil. Cependant, quand notre
modèle sera plus riche, il sera possible d'automatiser le calcul de cette
cellule.</p>
<h5 id="un-premier-outil--torrfacteurs--essayer">Un premier outil : torréfacteurs à essayer</h5>
<p>Une des forces de Notion et qu'il est possible <strong>de construire des prismes de
données</strong>, soit des <strong>vues qui appliquent des filtres et des méthodes de tris</strong>
sur des bases de données existantes. On peut donc facilement construire une vue
qui sert à lister l'ensemble des torréfacteurs encodés que je n'ai pas encore
essayé.</p>
<p>Par exemple, en prenant cette table <code>roasters</code> (avec un tout petit ensemble de
données), on voudrait qu'une vue <code>torréfacteurs à expérimenter</code> n'affiche que
<em>L'Arbre à Café</em>.</p>
<p><img src="/images/coffee-notion-roasters.png" alt="" class="aered-centered-fig" /></p>
<p>Pour cela, il suffit de construire une vue (avec le <em>layout</em> <strong>Liste</strong>) auquel
on ajoute un <a href="https://www.notion.so/help/guides/using-advanced-database-filters"><strong>filtre
avancé</strong></a>
pour lequel on dit que l'on veut que le champ <code>Tested</code> ne soit pas activé et le
champ <code>Active</code> est activé. La construction de filtres avancés est, de mon point
de vue, assez intuitive :</p>
<p><img src="/images/coffee-notion-roaster-filter.png" alt="" class="aered-centered-fig" /></p>
<p>Ce qui, logiquement, produit une vue ne prenant que les torréfacteurs <strong>actifs</strong>
et <strong>non-testés</strong>.</p>
<p><img src="/images/coffee-notion-roasters-view.png" alt="" class="aered-centered-fig" /></p>
<p>C'est en partie pour ce genre de <em>possibilités</em> que, à l'époque, j'avais décidé
d'utiliser Notion. Il existe plusieurs gabarits de vues (par exemple, celle qui
permet d'afficher les données sous forme de tables <em>Kanban</em>) et couplés et tris
et aux filtres, il est possible de construire des vues spécifiques (et
embarquables dans d'autres documents) pour répondre à des questions très
précies. Dans la suite de l'article, nous illustrerons d'autres utilisations de
ces vues.</p>
<h3 id="modlisation-du-caf-des-varits-et-des-grains">Modèlisation du café, des variétés et des grains</h3>
<p>On peut passer à la partie, de mon point de vue, la plus rigolote, <strong>on va
décrire le café</strong> ! Même si l'existe <strong>plus de 130 espèces de
<a href="https://en.wikipedia.org/wiki/Coffea">caféiers</a></strong>, on en distingue généralement
deux principales, utilisées pour faire du café :
<a href="https://en.wikipedia.org/wiki/Coffea_arabica">l'Arabica</a> et le
<a href="https://en.wikipedia.org/wiki/Coffea_canephora">Canephora</a> — que l'on appelle
généralement <strong>Robusta</strong>. Dans le café de spécialité, on trouvera presque
exclusivement de <em>L'Arabica</em>, qui est un arbre plus dur à entretenir mais qui
produit du café de meilleur qualité. Ensuite il existe une très grande
collection de variétés de café dérivés du Robusta et de l'Arabica, que l'on
appelle des <em>Cultivars</em> (ou variétés cultivées). Dans les rubriques qui suivent,
nous tâcherons de modéliser les tables décrivant les variétés de cafés pour
ensuite décrire les grains torréfiés.</p>
<h4 id="dcrire-les-varits-de-caf">Décrire les variétés de café</h4>
<p>Une première question de <em>design</em> se pose assez directement. Bien que l'on sait
que généralement, on aura une distinction entre Arabica et Robusta, doit-on
dédier une table pour décrire les caféiers ou peut-on juste considérer que c'est
un champ compacte — par exemple <code>is_arabica</code>, étant un booléen et dont la valeur
<code>false</code> impliquerait que le caféier serait Robusta. Je n'ai pas d'opinion forte
sur la meilleure approche donc je vais dédier une table spécifique, ce qui me
permettra d'utiliser la page adossée à une entrée — dans Notion, il est possible
d'ajouter du contenu additionnel à chaque entrée dans une table — pour collecter
des notes relatives aux caféiers. On peut donc décrire les variétés de cette
manière :</p>
<p><img src="/images/coffee-cultivar.svg" alt="" class="centered-fig" /></p>
<p>Les espèces (<code>species</code>) ne sont pas très originales, je stocke juste le <strong>nom
bref</strong> et le <strong>nom complet</strong>. Ensuite, pour les <em>cultivars</em>, je stocke un
<strong>nom</strong>, un <strong>lien</strong> (qui pointe généralement vers l'excellent index <a href="https://worldcoffeeresearch.org/">World
Coffee Research</a>), une liste de <strong>noms
alternatifs</strong> (par exemple, la variété <em>Villa Sarchi</em> est aussi appelée
<em>Villalobos</em>), une <strong>espèce</strong> (<em>Arabica</em> ou <em>Robusta</em>) et des potentiels
<strong>cultivars parents</strong>.</p>
<p>La référence de cultivars parents permet de capturer des mutations génétiques
artificielle ou naturelle. Par exemple, le <a href="https://perfectdailygrind.com/2023/10/pink-bourbon-specialty-coffee/">Bourbon
Rose</a> est
une mutation naturelle du
<a href="https://varieties.worldcoffeeresearch.org/varieties/bourbon">Bourbon</a> (un des
cultivars les plus populaires) et le <a href="https://varieties.worldcoffeeresearch.org/varieties/mundo-novo">Mundo
Novo</a> est une
mutation artificielle de
<a href="https://varieties.worldcoffeeresearch.org/varieties/typica">Typica</a>
(probablement la variété la plus ancienne) et de
<a href="https://varieties.worldcoffeeresearch.org/varieties/bourbon">Bourbon</a>. Cette
précision peut passer pour de la coquetterie, cependant, je trouve qu'avoir une
idée approximative de la lignée de variétés permet d'avoir une meilleure
compréhension des caractéristiques de ces dernières.</p>
<p>Maintenant, nous avons toutes les tables permettant de décrire <strong>les grains
torréfiés</strong>.</p>
<h4 id="dcrire-les-grains-torrfis">Décrire les grains torréfiés</h4>
<p>Nous avons tous les ingrédients nous permettant de décrire le grain que nous
allons utilisé pour faire une tasse. Ce sera donc naturellement une des tables
les plus touffue de notre système. Logiquement, nous retrouverons les
<strong>producteurs</strong> (fermes) et les <strong>torréfacteurs</strong>, les <strong>régions</strong> (on pourrait
imaginer que le producteur suffirait à décrire la région, mais je ne suis pas
sur que toutes les fermes soient parfaitement situé dans une seule région, et
certains grains peuvent être le fruit d'une collaboration entre deux fermes, où
l'un fournit les cerises et l'autres pratique la fermentation, d'où ma nécéssité
de dupliquer la région), on retrouvera la liste de <strong>variétés</strong> (quand un café
n'est composé que d'une seule variété, on parle d'origine unique, quand il est
composé de plusieurs variété, on parlera de <em>blend</em>) et d'autres champs que je
décrirai aprés vous avoir présenté la structure (pour ne pas trop alourdir le
schéma, j'ai pris la liberté de ne pas reproduire les tables des relations):</p>
<p><img src="/images/coffee-bean.svg" alt="" class="centered-fig" /></p>
<p>C'est le modèle qui, rétrospectivement, m'aura demandé le plus de réflexion et
il souffre de lacunes. Les champs <code>Cultivars</code>, <code>Farms</code>, <code>Roasters</code> et <code>Regions</code>
acceptent <strong>plusieurs</strong> relations pour caractériser les <em>collaborations</em> et
potentiellement les <em>blends</em>.</p>
<p>Le processus est décrit par le champ <code>Process</code> qui permet la sélection dans une
liste de méthode de séchage, cette liste peut évidemment évoluer dans le temps
même si, après plusieurs années de dégustation de café, elle me semble
exhaustive.</p>
<p>Ensuite on peut caractériser la <strong>fermentation</strong>, que l'on énumérera. En l'état,
j'ai observé <strong>l'absence de fermentation complémentaire</strong>, (ou café
<em>aérobique</em>), la <strong>fermentation anaérobique</strong>, la <strong>fermentation carbonique</strong> et
la <strong>fermentation lactique</strong> (en cas de nouvelles découvertes, cette liste peut,
évidemment, changer). En complément du processus de fermentation additionnelle,
il est important de consigner la durée de fermentation (en heure). Au contraire
de Excel, il n'est pas possible d'invalider cette valeur en cas d'absence de
fermentation, cependant, il serait possible (mais peut-être un peu exagéré)
d'ajouter un champ de type formule, qui utilise la valeur du champ
<code>Fermentation_duration</code> si la fermentation est différente de <code>None</code> et de
renvoyer <code>0</code> sinon. <strong>L'infusion</strong> durant la fermentation est un <em>booléen</em> (pour
lequel il serait possible d'appliquer la même technique que pour la durée de
fermentation car cette infusion n'a de sens qu'en cas de café fermenté
additionnellement). On pourrait déplorer l'absence des fruits ou arômes utilisés
pour l'infusion mais, de mon expérience, la <strong>liste des arômes</strong> (<code>Flavours</code>)
fournies par le torréfacteur suffit pour me faire une opinion.</p>
<p>Le <strong>niveau de torréfaction</strong> est une indication assez peu précise, en effet,
généralement, les valeurs <code>dark</code> et <code>extradark</code> ne sont jamais utilisées dans le
café de spécialité, les torréfacteurs cherchant généralement à garder une trace
du terroir. Et généralement, au plus le niveau de torréfaction est élevé, au
plus le café tend vers l'amertume, qui est généralement une caractéristique que
l'on veut éviter (ou du moins contrôler). Après plusieurs années d'utilisations,
je n'utilise généralement que les valeurs <code>light</code> et <code>middle</code>. En effet, comme
il n'existe pas réellement de consensus sur les niveau de notation du niveau de
torréfaction, je suis assez approximatif.</p>
<p>Le champ <strong>Altitude</strong> peut être surprenant, en effet, nous aurions pu le placer
au niveau de la ferme, cependant, j'imagine que certaines fermes peuvent étendre
leurs plantations sur plusieurs hectares et donc, potentiellement sur plusieurs
niveau d'altitudes. Je n'ai pas encore réussi à trouver une approche compacte et
ergonomique de gérer des <em>blends</em> de plusieurs grains à plusieurs niveaux de
récoltes.</p>
<p>Le dernier champ est le <strong>Score SCA</strong>, <a href="https://en.wikipedia.org/wiki/Specialty_coffee#Definition">un score destiné à classer le café de
spécialité</a>, initié
par la <a href="https://sca.coffee">Specialty Coffee Association</a>. Sa valeur est donc un
indice <strong>très révélateur</strong> la qualité globale du café.</p>
<p>Même si le modèle n'est, malheureusement, pas parfait, il est, de mon point de
vue, suffisant pour construire une sacré intuition sur <em>mon appréciation
générale du café</em>.</p>
<h5 id="amlioration-triviale">Amélioration triviale</h5>
<p>Quand j'ai partagé l'article sur différents réseaux, <a href="https://github.com/q-rault">Quentin
Rault</a> m'a, dans <a href="https://www.linkedin.com/feed/update/urn:li:activity:7155947052378521600?commentUrn=urn%3Ali%3Acomment%3A%28activity%3A7155947052378521600%2C7156372641266716673%29&amp;dashCommentUrn=urn%3Ali%3Afsd_comment%3A%287156372641266716673%2Curn%3Ali%3Aactivity%3A7155947052378521600%29">cette
conversation</a>,
très cordialement fait remarquer que je pourrai <strong>diviser</strong> le modèle <code>beans</code> en
deux modèles :</p>
<ul>
<li><code>GreenBeans</code> décrivant les grains <strong>avant torréfaction</strong> ;
</li>
<li><code>RoastedBeans</code> décrivant les grains <strong>après torréfaction</strong> (qui entretien une
relation avec <code>GreenBeans</code>).
</li>
</ul>
<p>L'avantage de cette séparation, c'est qu'elle permet d'éviter la redondance
d'informations quand des torréfacteurs torréfient les mêmes grains verts. En
effet, les producteurs vendent le fruit de leurs productions à plusieurs
torréfacteurs différents. C'est donc une amélioration triviale, améliorant
largement le modèle.</p>
<h5 id="un-second-outil-diversifier-les-expriences">Un second outil: diversifier les expériences</h5>
<p>Comme dans beaucoup de disciplines qui proposent des paramètres variés — et ici,
le nombre de champs décrivant des <em>grains torréfiés</em> et le nombre de <em>processus
de séchage</em> promettent beaucoup de diversités — l'expérimentation d'un maximum
de ces paramètres est capital ! C'est pour ça qu'en utilisant <strong>une vue</strong>, de
type <a href="https://www.notion.so/help/boards">Kanban</a>, utilisant le <strong>processus de
séchage</strong>, par exemple, il est possible d'avoir assez rapidement une vision
panoramique des grains qu'il <em>faudrait plus tester</em>. En 2021, après avoir
construit la première itération de cette collection de tables pour indexer mon
café, la vue Kanban des grains torréfiés m'a rapidement permis de me rendre
compte que j'avais un peu trop délaissé les cafés <em>Honey</em>, me permettant de
conditionner un peu mes achats pour diversifier ma connaissance du café !</p>
<p>Avec ce modèle, relativement modulaire, il est possible de jouer avec les vues,
leurs approvisionnements dynamiques et les filtres pour faire remonter des
signaux de consommation faible.</p>
<p>Maintenant, nous pouvons passer à la dernière étape de modélisation, qui tirera
partit de toutes les étapes précédentes : les recettes !</p>
<h3 id="modlisation-des-recettes-et-expriences">Modèlisation des recettes et expériences</h3>
<p>Même si nous avons modélisé quelques tables et que nous pouvons <em>relativement
précisemment</em> décrire des grains torréfiés, on peut remarquer que à aucun
moment, on a décrit l'interprétation (si on aime ou non) d'une tasse. Même si
nous aurions pu ajouter un champ <code>Personal_score</code> (en contraste avec le score
<em>SCA</em>) dans la table des grains torréfiés, je pense que ça aurait été un champ
<em>un peu flou</em>. En effet, bien qu'il soit possible de retirer <strong>beaucoup
d'informations</strong> de notre modèle actuel, il reste beaucoup de paramètres qui,
selon moi, ne devraient pas être associés à la description des grains. La
fraicheur du café (sa date de torréfaction) et la préparation mise en œuvre
jouent un rôle capital dans l'appréciation de la tasse.</p>
<p>Le fait de stocker des expérimentation de recettes m'a permis, au fil des
dégustations, d'ajuster les recettes choisies en fonction des caractéristiques
du café mais aussi d'ajuster <em>paramètres par défauts d'une recette</em> pour
approcher, au premier coup la recette idéale. Pour permettre la saisie, de
manière pertinente, des préparations, on va séparer la description de la recette
et son expérimentation. Mais avant de décrire la recette, intéressons-nous à la
description des machines à café.</p>
<h4 id="dcrire-les-machines--caf">Décrire les machines à café</h4>
<p>Même si, de manière assez naïve, on pourrait croire que la description d'une
machine à café ne consiste qu'a leur attribuer un nom — et donc qu'il n'est pas
nécéssaire de leur dédier une table — on se rend vite compte que <em>pour des
soucis de commodités</em>, on voudrait avoir une représentation hiérarchisée.</p>
<p>En effet, pour caractériser une machine, je peux soit utiliser un
<a href="https://www.notion.so/help/database-properties"><em>Multi-Select</em></a> me permettant
d'être assez libre concernant le niveau de granularité que je souhaite, soit je
peux décrire un ensemble de tables hiérarchisées. Dans la version originale de
l'article, j'utilisais un selecteur multiple, mais dans cette refonte, j'ai pris
la décision d'utiliser deux tables. La première me permettant de décrire <strong>la
catégorie</strong> de machine (par exemple <em>Pour Over</em>, <em>French Press</em>, <em>Aeropress</em>,
<em>Espresso</em> etc.) et une seconde qui décrit plus précisemment la <strong>cafetière</strong>.</p>
<p><img src="/images/coffee-brewer.svg" alt="" class="centered-fig" /></p>
<p>Rien de particulier à notifier, mais cette découpe permet de décrire une recette
pour une <strong>catégorie de cafetières</strong>, et d'associer une expérimentation à une
<strong>cafetière particulière</strong>. Maintenant, on peut décrire la description d'une
recette.</p>
<h4 id="dcrire-une-recette">Décrire une recette</h4>
<p>On va pouvoir passer à la partie rigolote, on va décrire une recette ! Pour ça,
on va utiliser une spécificité de Notion dont j'avais déjà un peu parlé dans la
description des variétés de café. En effet, <strong>une entrée dans une table Notion
attache automatiquement un document</strong>. Nous allons nous servir d'une table pour
décrire les méta-données de la recette, et ensuite, <strong>nous utiliserons le corps
de l'entrée pour décrire les différentes étapes de l'extraction</strong>. Auparavant,
j'avais expérimenté des niveaux de modélisation plus fins, en considérant que
les étapes étaient elles aussi des entrées dans une table, mais c'était très peu
confortable et l'excès de normalisation rendait la description d'une recette
compliquée.</p>
<p><img src="/images/coffee-recipe.svg" alt="" class="centered-fig" /></p>
<p>Les premiers champs sont assez évident, on <strong>nomme</strong> la recette, et on lui
attribue une <strong>source</strong> (généralement la page ou la vidéo qui la décrit) et on
lui associe une <strong>catégorie de machines</strong>. Comme il arrive que certaines
recettes soit spécifiquement <em>designés</em> pour une machine particulière, le champ
<strong>Machine recommandée</strong> permet de tracer cette particularité.</p>
<p>La <strong>température de l'eau</strong> est un facteur qui influe beaucoup sur la recette,
ainsi que la <strong>granulométrie de la mouture</strong> (que je compte en nombre de cliques
dans mon moulin <a href="https://www.comandantegrinder.com/">Commandante C40</a>). Le
dernier champ, le <strong>ratio</strong> permet de compacter le rapport <em>eau/quantité de
café</em>.</p>
<h5 id="explication-du-ratio">Explication du ratio</h5>
<p>Dans les descriptions de préparations du café que l'on peut trouver dans la
littérature, il est courant d'être confronté à un ratio. Le ratio est une
notation compacte permettant de décrire le rapport entre la quantité d'eau et de
café nécéssaire pour une préparation. Cette notation permet d'éviter l'horreur
de l'imprécision des mesures volumétriques (par exemple, 2 cuillières à soupe de
café) et ne repose que sur le poids. En général, le ratio est décrit de cette
manière : <code>1:X</code> qui peut se lire de cette manière : <code>1g de café pour Xg d'eau</code>.</p>
<p>Par exemple, un ratio <em>typique des méthodes douces</em>, <code>1:18</code>, permet de calculer
très rapidement soit la quantité d'eau souhaitée pour une portion de café
donnée, soit la quantité de café souhaitée pour une portion d'eau données (la
magie de l'arithmétique) :</p>
<ul>
<li>pour 20g de café : <code>20 * 18</code> = <code>360g</code> d'eau
</li>
<li>pour 240g d'eau : <code>240 / 18</code> = <code>~13g</code> de café
</li>
</ul>
<p>Dans mon modèle, je ne stocke que le <code>X</code> de la formule, le <code>1</code> étant constant,
ce qui me permettra de l'utiliser numeriquement dans un outil.</p>
<h5 id="un-troisime-outil--un-assistant-de-calcul">Un troisième outil : un assistant de calcul</h5>
<p>Maintenant que nous savons ce qu'est le ratio, nous pouvons créer un nouvel
outil, qui nous permettra de définir <strong>la quantité d'eau à utiliser pour une
recette spécifique</strong>, en fonction d'une quantité de café. On préférera souvent
calculer la quantité d'eau en fonction du café plutôt que l'inverse car c'est
plus souvent notre quantité de café qui conditionne notre recette plutôt que
l'inverse et que généralement, on choisi son café avant de servir son eau.</p>
<p>Pour ce faire, nous allons créer, dans notre page <code>tools</code> une base de données
<code>inline</code>, qui ne contiendra qu'une seule entrée. Avec, en plus du nom, 4 champs :</p>
<ol>
<li><code>Recipe</code>, une relation sur la recette que l'on voudra utiliser comme base ;
</li>
<li><code>Ratio</code>, un rollup sur la relation <code>Recipe</code> qui pointe vers le champ
<code>Ratio</code>, nous permettant de rendre le ratio de la recette accessible ;
</li>
<li><code>Coffee</code>, un champ numérique qui servira à contenir la quantité de café utilisée ;
</li>
<li><code>Water</code>, un champ <code>formule</code> qui affichera la quantité d'eau nécéssaire.
</li>
</ol>
<p>Maintenant que nos champs sont préparé, nous allons pouvoir construire la
formule. Même si l'opération arithmétique est très simple, le modèle de relation
de Notion implique quelques complications. En effet, il n'est <strong>pas possible</strong>
de forcer un champ à n'avoir qu'une seule relation. Ce qui implique que la
formule doit être écrite de cette manière : <code>prop(&quot;Coffee&quot;) * prop(&quot;Ratio&quot;).at(0)</code>. Qui peut se lire de cette manière : <em>multiplie la
propriété &quot;Coffee&quot; par la première valeur de &quot;Ratio&quot;</em>.</p>
<p>Cet outil nous montre quelques limites inhérentes à Notion, pouvant être
ennuyante quand on essaie de faire des outils plus ambitieux :</p>
<ul>
<li>l'impossibilité de décrire une relation unique ;
</li>
<li>l'impossibilité de fixer la taille maximum d'une table. Ici, on voudrait
limiter notre table à une seule entrée pour construire un véritable <em>Widget</em>.
</li>
<li>l'obligation d'avoir une clé primaire (<code>Name</code>) qui, dans le cas d'une table à
une seule entrée, ne fait pas réellement sens.
</li>
</ul>
<p>Même si ces soucis existent, et sont étroitement liés au modèle <em>orienté tables</em>
de Notion, il est souvent possible de trouver une solution (parfois un peu
verbeuse) de contourner le problème.</p>
<h4 id="dcrire-une-exprimentation">Décrire une expérimentation</h4>
<p>A cette étape, on possède toutes les briques nécéssaires à <strong>réellement
caractériser notre expérience gustative</strong> ! On va donc pouvoir décrire chaque
<strong>expérience</strong>. Une expérience <strong>l'application d'une recette, avec une machine
spécifique et du grain spécifique</strong>. C'est la partie qui va, enfin, nous faire
remonter des métriques d'appréciation. En d'autres mots, une expérimentation
est, à la fois, une variation, et une spécialisation d'une recette.</p>
<p>Comme une recette fait office de guide, certains paramètres sont dupliqués, pour
permettre des ajustement en fonction du café utilisé, ou encore de la machine.
Comme pour le déroulé d'une recette, nous pourrons utiliser le document généré
par entrée pour collecter quelques notes complémentaires.</p>
<p><img src="/images/coffee-exp.svg" alt="" class="centered-fig" /></p>
<p>Une grande partie des champs a déjà été décrite dans les modélisation
précédentes, on notera que par recette, je stocke la <strong>date de torréfaction</strong>,
qui est un indicateur assez important concernant la fraîcheur du café torréfié.
En effet, il est courrant de laisser le café <em>dégazer</em> quelques jours après
torréfaction. Pour ma part, j'ai tendance à laisser le café se reposer jusqu'à
une semaine <em>post-torréfaction</em> et de le consommer dans les trois semaines qui
suivent cette semaine.</p>
<p>Le <strong>Score personnel</strong> est une note (sur 20), qui me permet de décrire un
ressentit général sur la qualité de ma tasse. D'où l'importance de stocker
l'heure à laquelle j'ai consommé mon café (ici, le champ <strong>Date</strong>) parce que
certains café, de mon point de vue, ne convienne pas le matin (par exemple, les
cafés fermentés). Ce champ sera capital dans les sections qui suivront car il
nous permettra de faire remonter des métriques intéressantes.</p>
<p>Le champ <strong>Ratio</strong> nous permet de calculer le ratio (logique) en fonction des
quantité d'eau et de café et sa formule est assez simple :
<code>prop(&quot;Water_quantity&quot;) / prop(&quot;Coffee_quantity&quot;)</code>.</p>
<p>Et le champ <strong>Fraîcheur du café</strong> est une simple soustraction, affichant le
résultat en <strong>semaines</strong> entre la date de préparation et celle de torréfaction,
et qui se matérialise par la formule suivante :
<code>prop(&quot;Date&quot;).dateBetween(prop(&quot;Torrefaction_date&quot;), &quot;weeks&quot;)</code>, ce qui montre
que le langage de formule de Notion est aussi très expressif quand il s'agit de
composer avec des dates.</p>
<p>Nous en avons fini avec la modélisation. A cette étape, l'exercice de saisir ce
genre d'informations est déjà, selon moi, un grand plus dans la tentative de
compréhension de ses goûts en café. Nous allons terminer sur une exploitation
d'une fonctionnalité liée aux relations pour construire des outils de synthèses
fins.</p>
<h2 id="plus-de-tableaux-de-bords">Plus de tableaux de bords</h2>
<p>Maintenant que nous avons un socle de collecte de données <em>complet</em>, nous allons
voir comment légèrement modifier nos modèles pour faire remonter des données
amusantes et pertinentes. Par exemple, comment trier mes cafés favoris, faire
remonter les fermes qui produisent les cafés que je préfère, quelles sont les
machines qui produisent des résultats qui me plaisent le plus ? En l'état,
l'ensemble de ces métriques est assez dur à collecter (dynamiquement),
cependant, nous allons voir que grâce à une fonctionnalité très utile de Notion,
il est possible de les implémenter. Pour l'article, nous nous focaliserons sur
une seule des problématiques : comment, en se basant sur les scores des
expérimentations, est-il possible de trier :</p>
<ul>
<li>les cafés que je préfère ;
</li>
<li>les torréfacteurs qui me procurent le plus de satisfaction ;
</li>
<li>les fermes/producteurs qui produisent le café qui me plait le plus.
</li>
</ul>
<p>En réalisant cet exemple, <em>en chaîne</em>, une collection de tableaux de bords, de
plus en plus complexes deviendront triviaux à implanter. Cependant, pour que
l'article ne quadruple pas de volume, nous nous contenterons de cet exemple.</p>
<h3 id="relations-bi-directionnelles">Relations bi-directionnelles</h3>
<p>Dans les propriétés d'une relation, il est possible de cocher la case <code>Show on relation_source</code> qui, quand il est coché, ajoute un champs dans la source de la
relation, toutes les entités reliées à une entrée. De ce fait, si dans la table
<code>experimentations</code>, je coche <code>Show on</code> pour <code>Beans</code>, alors par entrée de
<code>Beans</code>, j'aurai toutes les expérimentations basées sur ces grains. Couplé avec
les Rollups, il est possible de faire remonter, selon des agrégats, des valeurs.</p>
<h4 id="relations-bi-directionnelles-et-rollups--score-moyen">Relations bi-directionnelles et Rollups : score moyen</h4>
<p>Maintenant que toutes nos expérimentations sont accessibles par grains depuis la
table <code>Beans</code>, on peut <strong>ajouter un Rollup</strong> qui pointera la champ
<code>experimentations</code>, sélectionnant la propriété <code>Personal_score</code> en utilisant
comme <strong>fonction de calcul</strong> (le modificateur <code>calculate</code>) <code>Average</code>. Ce qui
aura pour effet de calculer la moyenne des scores personnels des
expérimentations par grains. Comme on voudrait appliquer la même logique pour
calculer le score moyen d'un torréfacteur et d'une ferme, om va dupliquer ce
champ calculé <strong>via la technique des champs miroirs</strong> (la moyenne étant le
résultat d'un Rollup) et on va rendre bi-directionnelles les relations entre les
grains torréfiés et les torréfacteurs et les fermes. On peut donc ajouter,
respectivement dans les tables des torréfacteurs et des fermes, un Rollup sur
les relations fraîchement modifiés en appliquant, ici aussi, la fonction de
calcul <code>Average</code>.</p>
<p>On dispose maintenant d'un score moyen d'expérimentation par grain, d'un score
moyen de grain par torréfacteurs et d'un score moyen de grain par producteurs.
Ce qui nous permet de construire des vues dédiés pour afficher mes producteurs
favoris, mes fermes favorites et mes grains favoris !</p>
<p>Pour ma part, après plusieurs années d'indexation, <a href="https://www.instagram.com/fincahartmann/?hl=fr">Finca
Hartmann</a> est la ferme à qui
j'ai attribué le plus haut score et <a href="https://www.cime-cafe.fr/">Cime</a> est le
torréfacteur qui arrive en tête.</p>
<p>En jouant sur la répercussion bi-directionnelle des relations, les champs
miroirs et les Rollups, il est possible de faire remonter des métriques
intéressantes et les possibilités sont incropyablement variées, par exemple, il
serait possible d'automatiser le calcul de la case <code>tested</code> en utilisant un
procédé similaire (et oui, si j'ai au moins une expérimentations qui référence
un torréfacteur, en d'autre termes, que le champ expérimentation n'est pas
vide, alors c'est qu'il a été testé) ! Nous en avons fini avec ma procédure et
mon système d'indexation de café, il est temps de conclure.</p>
<h2 id="en-conclusion">En conclusion</h2>
<p>L'article aura été, malheureusement, plus long que ce que j'avais espéré, et je
pense que pour conclure correctement, il est nécéssaire de découper cette
section en plusieurs parties. La première portera sur l'apport concret de
l'outil d'indexation, la seconde portera sur Notion et, plus spécifiquement, sur
le <em>LowCode</em> et la dernière portera sur l'avenir — hypothétique — que je réserve
à ce système. En tout cas, j'espère que cet article vous aura, un peu, transmis
mon intérêt pour le café ! C'est un monde fascinant, porté par des gens
fascinants ! Une grande partie de mon intérêt pour le café a réellement commencé
à se développer grâce à <a href="https://www.instagram.com/clementfaivre/">Clément</a>, à
l'époque du regreté Coøk Kaffé, me permettant de découvrir
<a href="https://www.aprilcoffeeroasters.com/">April</a>, s'est amplifié grâce à
l'expertise de <a href="https://www.instagram.com/baptistedmrt/">Baptiste</a> et à toute
l'équipe de <a href="https://www.cime-cafe.fr/">Cime</a>, dont le café est excellent (et
devenant mon torréfacteur favori) avec une mention pour
<a href="https://www.substancecafe.com/">Substance</a>, où chaque réservation est la
promesse d'un voyage incroyable et de découvertes, enrichi par de multitudes
d'informations sur le terroir, les producteurs et la préparation, et
<a href="https://www.instagram.com/kultivar_cafe_nantes/">Kultivar</a> qui m'a offert
l'opportunité de goûter des cafés fermentés de manière très originale et
dépaysant ! Ce qui rend le monde du café de spécialité encore plus <em>cool</em> que le
fait de pouvoir boire du bon café, c'est qu'il est tiré vers les hauts par des
personnalités non-avares en conseils, en discussions et en partage !</p>
<h3 id="aprs-2-ans-dutilisation">Après ~2 ans d'utilisation</h3>
<p>Avant de commencer à consigner consciencieusement mes expérimentations dans
l'index présenté dans cet article, j'utilisais essentiellement le <em>branding</em> et
la direction artistiques de torréfacteurs pour découvrir de nouveaux café.
L'utilisation d'un index m'a permis, <em>dans une phase de découverte</em>, de
diversifier volontairement mes choix, de comprendre — contextuellement —
l'intérêt/l'appréciation que je pouvais avoir de certains café et me construire
une intuition forte sur les arômes et la balance acidité/amertume que je
recherche, généralement, dans des tasses mais aussi de trouver des premiers
réglages <em>pertinents</em> pour expérimenter de nouveaux cafés. De plus, l'exercice
<em>de la documentation</em> est vraiment un outil formidable pour <em>stabiliser ses
connaissances</em> et même si je reste encore très néophyte dans le monde du café,
je pense que j'ai pu <em>plus apprendre</em> et progresser grâce à cetet indexation
méticuleuse.</p>
<p>En bref, je pense que dans beaucoup de disciplines, la construction d'indexes,
de bases de connaissances ou de dictionnaire est une bonne chose, et je pense
que mon indexation de café aura été, pour moi, utile tout en me permettant de
produire deux articles, ce qui, au vue de ma productivité rédactionnelle proche
du néant, est une sacré aubaine !</p>
<h3 id="sur-notion-et-le-lowcode">Sur Notion et le LowCode</h3>
<p>Même si, en tant que développeur, on regrettera certaines <em>pirouettes</em>
obligatoires, j'ai trouvé Notion ergonomique et très amusant à utiliser. De mon
point de vue, le modèle situé à l'intersection entre les tables relationnelles
et les <em>spreadsheets</em> est très versatile et, couplé à l'utilisation de son
<a href="https://developers.notion.com/">API</a>, il est possible de s'en servir comme d'un
véritable <em>back-end</em>, offrant rapidement de l'UI pour des données structurées.
C'était ma première expérience en <em>LowCode/NoCode</em> (autre qu'Excel) et je ne
suis pas déçu. Même en utilisant un tout petit sous-ensemble de l'application
(et passant à côté de pleins de fonctionnalités), j'ai été très impressionné par
la vitesse de <em>prototypage</em> que ce genre d'outil permet.</p>
<p>Je vais continuer à <em>lorgner</em> sur les alternatives (idéalement libres et
<em>local-first</em>) et continuer à expérimenter des technologies <em>LowCode</em> pour
résoudre des problèmes que je n'ai pas spécialement envie de développer
<em>from-scracth</em>. Si jamais vous avez des retours (positifs comme négatifs) sur
Notion ou des suggestions d'outils <em>LowCode/NoCode</em> à expérimenter, n'hésitez
pas à me contacter, je serais ravi de les découvrir.</p>
<p>En bref, bien qu'il ne soit pas possible, avec Notion, de construire <strong>tout ce
qu'il est possible de construire</strong> avec une base de données relationnelles et un
<em>front-end</em> dédié, l'outil couvre énormement de cas d'usage et offre un niveau
de généricité très avancé, couplé à une sacrement bonne ergonomie et ça vaut
probablement la peine de voir ce que le <em>LowCode</em> a à offrir. Dans mon cas,
Notion m'a permis de bénéficier, sur base de la description de données et de
structure de données, une interface graphique plus ou moins ergonomique,
gratuitement.</p>
<h3 id="la-suite">La suite</h3>
<p>La construction du système et sa documentation (cet article et son prédécesseur)
furent des exercices amusants, aboutissant à un outil que j'utilise
quotidiennement. En revanche, je pense que pour être <em>génériquement ergonomique</em>
— donc être utilisable par une autre personne que <strong>moi</strong>, et donc
potentiellement publiable sous forme de <em>template</em> ou du moins distribuable — il
reste <strong>beaucoup de travail</strong>. En effet, j'ai estampillé, tout au long de cet
article, des petits points de frustrations. Il est possible qu'ils ne soient
présent que parce que je maitrise mal Notion (et si c'est le cas, n'hésitez
surtout pas à me contacter pour m'expliquer comment améliorer mon système), mais
je pense que comme tout outil <em>tellement versatile</em>, se voulant être facile à
prendre en main, il est impossible de décrire avec précisions certaines
contraintes relationnelles ou certains modes de formattages. C'est pour ça qu'il
est possible (<em>hypothétiquement</em>) que je construise un logiciel dédié (et libre,
évidemment) me permettant de <em>relaxer</em> toutes ces contraintes !</p>
<p>Quoi qu'il en soit, le prototype Notion sera d'une grande aide, car il m'aura
permis de fournir une première modélisation, rendant l'usage du <em>LowCode</em>, comme
un outil de prototypage, parfaitement pertinent !</p>
<p>Pour terminer, n’hésitez pas à boire du bon café, à laisser tomber les machines
<em>Nespresso</em>, et à arrêter d’acheter du café trop fortement torréfié (à <em>la Carte
Noir</em> ou <em>Grand mère</em>) en grande surface et laissez-vous tenter par les plaisirs
du café de spécialité, cultivé, récolté, séché, et torréfié avec savoir, <strong>c’est
largement meilleur</strong>. Promis.</p>
</article>
<hr />
<section class="page-comment-widget">
  <h1>Commentaires</h1>
  <p class="hyphenate">
    Comme mon site web est hébergé sur un serveur de fichiers statiques (et ne
    dispose pas de base de données), les commentaires sont assurés par le
    <i>Fediverse</i>. Si vous possédez un compte, par exemple <i>Mastodon</i>,
    <strong>vous pouvez donc commenter</strong> cette page en répondant à ce
    <a
      href="https://merveilles.town/@xvw/111805129432519399"
      >fil de discussion</a
    >!
  </p>
  <script>
    nightmare_js.suspend(function () {
      capsule_widgets.mountComments(
        "comments-thread",
        "merveilles.town",
        "xvw",
        "111805129432519399"
      );
    });
  </script>
  <div id="comments-thread"></div>
</section></main>
    <footer>
      <div class="container">
        <div>
          <p>
            <a href="https://ring.muhokama.fun">Webring Muhokama</a><br />
            <a class="wb-btn" href="https://ring.muhokama.fun/u/xvw/pred"
              >Précédent</a
            >
            |
            <a class="wb-btn" href="https://ring.muhokama.fun/u/xvw/succ"
              >Suivant</a
            >
          </p>
        </div>
        <div>
          <p>
            Diffusé sous licence
            <a href="https://creativecommons.org/licenses/by-sa/4.0/">
              <strong>CC BY-SA</strong>
            </a>
          </p>
          <p>
            Honteuseument généré par
            <a href="https://github.com/xhtmlboi/yocaml">
              <strong>YOCaml</strong>
            </a>
          </p>
          <p class="feed-icons"><a href="/feeds.html">⛰</a></p>
        </div>
      </div>
    </footer>
    <script>
      nightmare_js.suspend(function () {
        capsule_hljs.run();
      });
      nightmare_js.mount();
    </script>
  </body>
</html>
